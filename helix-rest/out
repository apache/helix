[INFO] Scanning for projects...
[INFO] 
[INFO] --------------------< org.apache.helix:helix-rest >---------------------
[INFO] Building Apache Helix :: Restful Interface 1.0.3-SNAPSHOT
[INFO] -------------------------------[ bundle ]-------------------------------
Downloading from apache.snapshots: http://repository.apache.org/snapshots/org/apache/helix/metadata-store-directory-common/1.0.3-SNAPSHOT/maven-metadata.xml
Downloading from apache.snapshots: http://repository.apache.org/snapshots/org/apache/helix/helix/1.0.3-SNAPSHOT/maven-metadata.xml
Downloading from apache.snapshots: http://repository.apache.org/snapshots/org/apache/helix/helix-core/1.0.3-SNAPSHOT/maven-metadata.xml
Downloading from apache.snapshots: http://repository.apache.org/snapshots/org/apache/helix/helix-common/1.0.3-SNAPSHOT/maven-metadata.xml
Downloading from apache.snapshots: http://repository.apache.org/snapshots/org/apache/helix/metrics-common/1.0.3-SNAPSHOT/maven-metadata.xml
Downloading from apache.snapshots: http://repository.apache.org/snapshots/org/apache/helix/zookeeper-api/1.0.3-SNAPSHOT/maven-metadata.xml
[INFO] 
[INFO] --- jacoco-maven-plugin:0.8.6:prepare-agent (default) @ helix-rest ---
[INFO] argLine set to -javaagent:/Users/xialu/.m2/repository/org/jacoco/org.jacoco.agent/0.8.6/org.jacoco.agent-0.8.6-runtime.jar=destfile=/Users/xialu/Documents/WorkSpace/helix/helix-rest/target/jacoco.exec
[INFO] 
[INFO] --- maven-remote-resources-plugin:1.4:process (default) @ helix-rest ---
[INFO] 
[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ helix-rest ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 0 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- maven-compiler-plugin:2.5.1:compile (default-compile) @ helix-rest ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-bundle-plugin:3.5.0:manifest (bundle-manifest) @ helix-rest ---
[WARNING] Manifest org.apache.helix:helix-rest:bundle:1.0.3-SNAPSHOT : Unused Import-Package instructions: [org.restlet*, org.apache.commons.io*] 
[INFO] 
[INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ helix-rest ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 1 resource
[INFO] Copying 3 resources
[INFO] 
[INFO] --- maven-compiler-plugin:2.5.1:testCompile (default-testCompile) @ helix-rest ---
[INFO] Compiling 1 source file to /Users/xialu/Documents/WorkSpace/helix/helix-rest/target/test-classes
[INFO] 
[INFO] --- maven-surefire-plugin:3.0.0-M3:test (default-test) @ helix-rest ---
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running TestSuite
Start zookeeper at localhost:2123 in thread main
Start zookeeper at localhost:2124 in thread main
0    [HelixController-pipeline-task-StoppableTestCluster-(4e474af5_TASK)] ERROR org.apache.helix.task.AbstractTaskDispatcher  - The job config is missing for job Workflow_0_JOB2
4    [HelixController-pipeline-task-StoppableTestCluster-(4e474af5_TASK)] ERROR org.apache.helix.task.AbstractTaskDispatcher  - The job config is missing for job Workflow_0_JOB1
4    [HelixController-pipeline-task-StoppableTestCluster-(4e474af5_TASK)] ERROR org.apache.helix.task.AbstractTaskDispatcher  - The job config is missing for job Workflow_0_JOB0
17   [HelixController-pipeline-task-StoppableTestCluster-(f3a610b3_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB2
17   [HelixController-pipeline-task-StoppableTestCluster-(f3a610b3_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB1
18   [HelixController-pipeline-task-StoppableTestCluster-(f3a610b3_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB0
27   [HelixController-pipeline-task-StoppableTestCluster-(5e300b84_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB2
27   [HelixController-pipeline-task-StoppableTestCluster-(5e300b84_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB1
27   [HelixController-pipeline-task-StoppableTestCluster-(5e300b84_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB0
27   [HelixController-pipeline-task-StoppableTestCluster-(5e300b84_TASK)] ERROR org.apache.helix.task.AbstractTaskDispatcher  - The job config is missing for job Workflow_1_JOB1
31   [HelixController-pipeline-task-StoppableTestCluster-(5e300b84_TASK)] ERROR org.apache.helix.task.AbstractTaskDispatcher  - The job config is missing for job Workflow_1_JOB0
45   [HelixController-pipeline-task-StoppableTestCluster-(86f90b9f_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB2
45   [HelixController-pipeline-task-StoppableTestCluster-(86f90b9f_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB1
45   [HelixController-pipeline-task-StoppableTestCluster-(86f90b9f_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB0
45   [HelixController-pipeline-task-StoppableTestCluster-(86f90b9f_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB1
45   [HelixController-pipeline-task-StoppableTestCluster-(86f90b9f_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB0
55   [HelixController-pipeline-task-StoppableTestCluster-(2b2a4383_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB2
55   [HelixController-pipeline-task-StoppableTestCluster-(2b2a4383_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB1
55   [HelixController-pipeline-task-StoppableTestCluster-(2b2a4383_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB0
56   [HelixController-pipeline-task-StoppableTestCluster-(2b2a4383_TASK)] ERROR org.apache.helix.task.AbstractTaskDispatcher  - The job config is missing for job Workflow_2_JOB1
56   [HelixController-pipeline-task-StoppableTestCluster-(2b2a4383_TASK)] ERROR org.apache.helix.task.AbstractTaskDispatcher  - The job config is missing for job Workflow_2_JOB0
56   [HelixController-pipeline-task-StoppableTestCluster-(2b2a4383_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB1
56   [HelixController-pipeline-task-StoppableTestCluster-(2b2a4383_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB0
64   [HelixController-pipeline-task-StoppableTestCluster-(a833373e_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB2
65   [HelixController-pipeline-task-StoppableTestCluster-(a833373e_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB1
65   [HelixController-pipeline-task-StoppableTestCluster-(a833373e_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB0
65   [HelixController-pipeline-task-StoppableTestCluster-(a833373e_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB1
65   [HelixController-pipeline-task-StoppableTestCluster-(a833373e_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB0
65   [HelixController-pipeline-task-StoppableTestCluster-(a833373e_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB1
65   [HelixController-pipeline-task-StoppableTestCluster-(a833373e_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB0
71   [HelixController-pipeline-task-StoppableTestCluster-(391bbb0a_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB2
71   [HelixController-pipeline-task-StoppableTestCluster-(391bbb0a_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB1
72   [HelixController-pipeline-task-StoppableTestCluster-(391bbb0a_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB0
72   [HelixController-pipeline-task-StoppableTestCluster-(391bbb0a_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB1
72   [HelixController-pipeline-task-StoppableTestCluster-(391bbb0a_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB0
72   [HelixController-pipeline-task-StoppableTestCluster-(391bbb0a_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB1
72   [HelixController-pipeline-task-StoppableTestCluster-(391bbb0a_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB0
Start test :testGetJobs
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testGetJobs
Start test :testGetJob
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testGetJob
Start test :testGetJobConfig
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testGetJobConfig
Start test :testGetJobContext
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testGetJobContext
Start test :testCreateJob
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testCreateJob
Start test :testGetAddJobContent
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testGetAddJobContent
Start test :testInvalidGetAndUpdateJobContentStore
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
2173 [HelixTaskExecutor-message_handle_thread_915] ERROR org.apache.helix.messaging.handling.HelixStateTransitionHandler  - Exception while executing a state transition task TestQueue_TestJob_1
java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.helix.messaging.handling.HelixStateTransitionHandler.invoke(HelixStateTransitionHandler.java:386)
	at org.apache.helix.messaging.handling.HelixStateTransitionHandler.handleMessage(HelixStateTransitionHandler.java:313)
	at org.apache.helix.messaging.handling.HelixTask.call(HelixTask.java:97)
	at org.apache.helix.messaging.handling.HelixTask.call(HelixTask.java:49)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: No callback implemented(or not registered) for task ReIndex
	at org.apache.helix.task.TaskStateModel.startTask(TaskStateModel.java:318)
	at org.apache.helix.task.TaskStateModel.onBecomeRunningFromInit(TaskStateModel.java:79)
	... 12 more
End test :testInvalidGetAndUpdateJobContentStore
2173 [HelixTaskExecutor-message_handle_thread_916] ERROR org.apache.helix.messaging.handling.HelixStateTransitionHandler  - Exception while executing a state transition task TestQueue_TestJob_0
java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.helix.messaging.handling.HelixStateTransitionHandler.invoke(HelixStateTransitionHandler.java:386)
	at org.apache.helix.messaging.handling.HelixStateTransitionHandler.handleMessage(HelixStateTransitionHandler.java:313)
	at org.apache.helix.messaging.handling.HelixTask.call(HelixTask.java:97)
	at org.apache.helix.messaging.handling.HelixTask.call(HelixTask.java:49)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: No callback implemented(or not registered) for task Backup
	at org.apache.helix.task.TaskStateModel.startTask(TaskStateModel.java:318)
	at org.apache.helix.task.TaskStateModel.onBecomeRunningFromInit(TaskStateModel.java:79)
	... 12 more
2181 [HelixTaskExecutor-message_handle_thread_915] ERROR org.apache.helix.util.StatusUpdateUtil  - StatusUpdate Error record: 10000cadc58001c__TestQueue_TestJob, {}{HELIX_ERROR     20210603-100753.000495 STATE_TRANSITION a178ac1b-4a8c-4c1f-b932-acfca94f8d96={AdditionalInfo=Exception while executing a state transition task TestQueue_TestJob_1java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.helix.messaging.handling.HelixStateTransitionHandler.invoke(HelixStateTransitionHandler.java:386)
	at org.apache.helix.messaging.handling.HelixStateTransitionHandler.handleMessage(HelixStateTransitionHandler.java:313)
	at org.apache.helix.messaging.handling.HelixTask.call(HelixTask.java:97)
	at org.apache.helix.messaging.handling.HelixTask.call(HelixTask.java:49)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: No callback implemented(or not registered) for task ReIndex
	at org.apache.helix.task.TaskStateModel.startTask(TaskStateModel.java:318)
	at org.apache.helix.task.TaskStateModel.onBecomeRunningFromInit(TaskStateModel.java:79)
	... 12 more
, Class=class org.apache.helix.messaging.handling.HelixStateTransitionHandler, MSG_ID=b25db81d-1b82-4f13-8850-dc22e6d0a1f0, Message state=READ}}{}
2181 [HelixTaskExecutor-message_handle_thread_916] ERROR org.apache.helix.util.StatusUpdateUtil  - StatusUpdate Error record: 10000cadc580028__TestQueue_TestJob, {}{HELIX_ERROR     20210603-100753.000496 STATE_TRANSITION b365c49d-73f1-4b47-bdc8-2b952c4f2820={AdditionalInfo=Exception while executing a state transition task TestQueue_TestJob_0java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.helix.messaging.handling.HelixStateTransitionHandler.invoke(HelixStateTransitionHandler.java:386)
	at org.apache.helix.messaging.handling.HelixStateTransitionHandler.handleMessage(HelixStateTransitionHandler.java:313)
	at org.apache.helix.messaging.handling.HelixTask.call(HelixTask.java:97)
	at org.apache.helix.messaging.handling.HelixTask.call(HelixTask.java:49)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: No callback implemented(or not registered) for task Backup
	at org.apache.helix.task.TaskStateModel.startTask(TaskStateModel.java:318)
	at org.apache.helix.task.TaskStateModel.onBecomeRunningFromInit(TaskStateModel.java:79)
	... 12 more
, Class=class org.apache.helix.messaging.handling.HelixStateTransitionHandler, MSG_ID=ea7e645d-1a1b-4ac4-a536-9fdbe700cd54, Message state=READ}}{}
Start test :testDeleteJob
2184 [HelixTaskExecutor-message_handle_thread_916] ERROR org.apache.helix.participant.statemachine.StateModel  - Default rollback method invoked on error. Error Code: ERROR
2184 [HelixTaskExecutor-message_handle_thread_915] ERROR org.apache.helix.participant.statemachine.StateModel  - Default rollback method invoked on error. Error Code: ERROR
2191 [HelixTaskExecutor-message_handle_thread_916] ERROR org.apache.helix.messaging.handling.HelixTask  - Message execution failed. msgId: ea7e645d-1a1b-4ac4-a536-9fdbe700cd54, errorMsg: java.lang.reflect.InvocationTargetException
2192 [HelixTaskExecutor-message_handle_thread_915] ERROR org.apache.helix.messaging.handling.HelixTask  - Message execution failed. msgId: b25db81d-1b82-4f13-8850-dc22e6d0a1f0, errorMsg: java.lang.reflect.InvocationTargetException
2195 [HelixTaskExecutor-message_handle_thread_915] ERROR org.apache.helix.util.StatusUpdateUtil  - StatusUpdate Error record: 10000cadc58001c__TestQueue_TestJob, {}{HELIX_ERROR     20210603-100753.000509 STATE_TRANSITION 5cceed8e-4b24-4a0a-8f7d-46f888161f4a={AdditionalInfo=Message execution failed. msgId: b25db81d-1b82-4f13-8850-dc22e6d0a1f0, errorMsg: java.lang.reflect.InvocationTargetException, Class=class org.apache.helix.messaging.handling.HelixStateTransitionHandler, MSG_ID=b25db81d-1b82-4f13-8850-dc22e6d0a1f0, Message state=READ}}{}
2195 [HelixTaskExecutor-message_handle_thread_916] ERROR org.apache.helix.util.StatusUpdateUtil  - StatusUpdate Error record: 10000cadc580028__TestQueue_TestJob, {}{HELIX_ERROR     20210603-100753.000509 STATE_TRANSITION fd44c6a8-bd16-4181-a3ce-5ace8f81f9b6={AdditionalInfo=Message execution failed. msgId: ea7e645d-1a1b-4ac4-a536-9fdbe700cd54, errorMsg: java.lang.reflect.InvocationTargetException, Class=class org.apache.helix.messaging.handling.HelixStateTransitionHandler, MSG_ID=ea7e645d-1a1b-4ac4-a536-9fdbe700cd54, Message state=READ}}{}
2196 [HelixTaskExecutor-message_handle_thread_916] ERROR org.apache.helix.messaging.handling.HelixStateTransitionHandler  - Skip internal error. errCode: ERROR, errMsg: null
2196 [HelixTaskExecutor-message_handle_thread_915] ERROR org.apache.helix.messaging.handling.HelixStateTransitionHandler  - Skip internal error. errCode: ERROR, errMsg: null
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testDeleteJob
Start test :testInstancesStoppable_zoneBased
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testInstancesStoppable_zoneBased
3296 [HelixController-pipeline-task-StoppableTestCluster-(3221250d_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB2
3297 [HelixController-pipeline-task-StoppableTestCluster-(3221250d_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB1
3297 [HelixController-pipeline-task-StoppableTestCluster-(3221250d_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB0
3297 [HelixController-pipeline-task-StoppableTestCluster-(3221250d_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB1
3297 [HelixController-pipeline-task-StoppableTestCluster-(3221250d_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB0
3297 [HelixController-pipeline-task-StoppableTestCluster-(3221250d_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB1
3297 [HelixController-pipeline-task-StoppableTestCluster-(3221250d_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB0
3307 [HelixController-pipeline-task-StoppableTestCluster-(14041a78_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB2
3307 [HelixController-pipeline-task-StoppableTestCluster-(14041a78_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB1
3307 [HelixController-pipeline-task-StoppableTestCluster-(14041a78_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB0
3307 [HelixController-pipeline-task-StoppableTestCluster-(14041a78_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB1
3307 [HelixController-pipeline-task-StoppableTestCluster-(14041a78_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB0
3307 [HelixController-pipeline-task-StoppableTestCluster-(14041a78_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB1
3307 [HelixController-pipeline-task-StoppableTestCluster-(14041a78_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB0
3325 [HelixController-pipeline-task-StoppableTestCluster-(f2b165f2_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB2
3325 [HelixController-pipeline-task-StoppableTestCluster-(f2b165f2_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB1
3325 [HelixController-pipeline-task-StoppableTestCluster-(f2b165f2_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB0
3325 [HelixController-pipeline-task-StoppableTestCluster-(f2b165f2_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB1
3325 [HelixController-pipeline-task-StoppableTestCluster-(f2b165f2_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB0
3325 [HelixController-pipeline-task-StoppableTestCluster-(f2b165f2_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB1
3325 [HelixController-pipeline-task-StoppableTestCluster-(f2b165f2_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB0
3333 [HelixController-pipeline-task-StoppableTestCluster-(79a232eb_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB2
3333 [HelixController-pipeline-task-StoppableTestCluster-(79a232eb_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB1
3333 [HelixController-pipeline-task-StoppableTestCluster-(79a232eb_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB0
3333 [HelixController-pipeline-task-StoppableTestCluster-(79a232eb_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB1
3333 [HelixController-pipeline-task-StoppableTestCluster-(79a232eb_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB0
3333 [HelixController-pipeline-task-StoppableTestCluster-(79a232eb_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB1
3333 [HelixController-pipeline-task-StoppableTestCluster-(79a232eb_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB0
3339 [HelixController-pipeline-task-StoppableTestCluster-(72610869_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB2
3339 [HelixController-pipeline-task-StoppableTestCluster-(72610869_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB1
3340 [HelixController-pipeline-task-StoppableTestCluster-(72610869_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB0
3340 [HelixController-pipeline-task-StoppableTestCluster-(72610869_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB1
3340 [HelixController-pipeline-task-StoppableTestCluster-(72610869_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB0
3340 [HelixController-pipeline-task-StoppableTestCluster-(72610869_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB1
3340 [HelixController-pipeline-task-StoppableTestCluster-(72610869_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB0
3346 [HelixController-pipeline-task-StoppableTestCluster-(4f24c016_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB2
3346 [HelixController-pipeline-task-StoppableTestCluster-(4f24c016_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB1
3346 [HelixController-pipeline-task-StoppableTestCluster-(4f24c016_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB0
3346 [HelixController-pipeline-task-StoppableTestCluster-(4f24c016_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB1
3346 [HelixController-pipeline-task-StoppableTestCluster-(4f24c016_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB0
3346 [HelixController-pipeline-task-StoppableTestCluster-(4f24c016_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB1
3346 [HelixController-pipeline-task-StoppableTestCluster-(4f24c016_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB0
3353 [HelixController-pipeline-task-StoppableTestCluster-(376ab038_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB2
3353 [HelixController-pipeline-task-StoppableTestCluster-(376ab038_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB1
3353 [HelixController-pipeline-task-StoppableTestCluster-(376ab038_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB0
3353 [HelixController-pipeline-task-StoppableTestCluster-(376ab038_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB1
3353 [HelixController-pipeline-task-StoppableTestCluster-(376ab038_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB0
3353 [HelixController-pipeline-task-StoppableTestCluster-(376ab038_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB1
3353 [HelixController-pipeline-task-StoppableTestCluster-(376ab038_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB0
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
3864 [HelixController-pipeline-task-StoppableTestCluster-(c2ffbd8a_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB2
3864 [HelixController-pipeline-task-StoppableTestCluster-(c2ffbd8a_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB1
3864 [HelixController-pipeline-task-StoppableTestCluster-(c2ffbd8a_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB0
3864 [HelixController-pipeline-task-StoppableTestCluster-(c2ffbd8a_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB1
3864 [HelixController-pipeline-task-StoppableTestCluster-(c2ffbd8a_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB0
3864 [HelixController-pipeline-task-StoppableTestCluster-(c2ffbd8a_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB1
3864 [HelixController-pipeline-task-StoppableTestCluster-(c2ffbd8a_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB0
3873 [HelixController-pipeline-task-StoppableTestCluster-(89141efb_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB2
3873 [HelixController-pipeline-task-StoppableTestCluster-(89141efb_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB1
3873 [HelixController-pipeline-task-StoppableTestCluster-(89141efb_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB0
3873 [HelixController-pipeline-task-StoppableTestCluster-(89141efb_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB1
3873 [HelixController-pipeline-task-StoppableTestCluster-(89141efb_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB0
3873 [HelixController-pipeline-task-StoppableTestCluster-(89141efb_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB1
3873 [HelixController-pipeline-task-StoppableTestCluster-(89141efb_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB0
3881 [HelixController-pipeline-task-StoppableTestCluster-(c8bab79e_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB2
3881 [HelixController-pipeline-task-StoppableTestCluster-(c8bab79e_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB1
3881 [HelixController-pipeline-task-StoppableTestCluster-(c8bab79e_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB0
3881 [HelixController-pipeline-task-StoppableTestCluster-(c8bab79e_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB1
3881 [HelixController-pipeline-task-StoppableTestCluster-(c8bab79e_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB0
3881 [HelixController-pipeline-task-StoppableTestCluster-(c8bab79e_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB1
3881 [HelixController-pipeline-task-StoppableTestCluster-(c8bab79e_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB0
3888 [HelixController-pipeline-task-StoppableTestCluster-(2e15190d_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB2
3888 [HelixController-pipeline-task-StoppableTestCluster-(2e15190d_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB1
3888 [HelixController-pipeline-task-StoppableTestCluster-(2e15190d_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB0
3888 [HelixController-pipeline-task-StoppableTestCluster-(2e15190d_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB1
3888 [HelixController-pipeline-task-StoppableTestCluster-(2e15190d_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB0
3888 [HelixController-pipeline-task-StoppableTestCluster-(2e15190d_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB1
3888 [HelixController-pipeline-task-StoppableTestCluster-(2e15190d_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB0
3894 [HelixController-pipeline-task-StoppableTestCluster-(88e8c6bb_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB2
3894 [HelixController-pipeline-task-StoppableTestCluster-(88e8c6bb_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB1
3895 [HelixController-pipeline-task-StoppableTestCluster-(88e8c6bb_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB0
3895 [HelixController-pipeline-task-StoppableTestCluster-(88e8c6bb_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB1
3895 [HelixController-pipeline-task-StoppableTestCluster-(88e8c6bb_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB0
3895 [HelixController-pipeline-task-StoppableTestCluster-(88e8c6bb_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB1
3895 [HelixController-pipeline-task-StoppableTestCluster-(88e8c6bb_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB0
3901 [HelixController-pipeline-task-StoppableTestCluster-(f19d3a53_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB2
3901 [HelixController-pipeline-task-StoppableTestCluster-(f19d3a53_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB1
3901 [HelixController-pipeline-task-StoppableTestCluster-(f19d3a53_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB0
3901 [HelixController-pipeline-task-StoppableTestCluster-(f19d3a53_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB1
3901 [HelixController-pipeline-task-StoppableTestCluster-(f19d3a53_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB0
3901 [HelixController-pipeline-task-StoppableTestCluster-(f19d3a53_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB1
3901 [HelixController-pipeline-task-StoppableTestCluster-(f19d3a53_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB0
3907 [HelixController-pipeline-task-StoppableTestCluster-(490270b0_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB2
3907 [HelixController-pipeline-task-StoppableTestCluster-(490270b0_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB1
3907 [HelixController-pipeline-task-StoppableTestCluster-(490270b0_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB0
3907 [HelixController-pipeline-task-StoppableTestCluster-(490270b0_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB1
3907 [HelixController-pipeline-task-StoppableTestCluster-(490270b0_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB0
3907 [HelixController-pipeline-task-StoppableTestCluster-(490270b0_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB1
3907 [HelixController-pipeline-task-StoppableTestCluster-(490270b0_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB0
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testInstancesStoppable_disableOneInstance
Start test :testGetAllInstances
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testGetAllInstances
Start test :testValidateWeightForAllInstances
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
4511 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12925, capacity map: {}.
4512 [HelixController-pipeline-default-TestCluster_0-(59979390_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12920, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
4532 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12925, capacity map: {}.
4535 [HelixController-pipeline-default-TestCluster_0-(afd638b7_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12920, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
4546 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12921, capacity map: {}.
4547 [HelixController-pipeline-default-TestCluster_0-(40c2ff41_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12920, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
4559 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12922, capacity map: {}.
4560 [HelixController-pipeline-default-TestCluster_0-(ba7fd6e9_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12920, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
4573 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12925, capacity map: {}.
4574 [HelixController-pipeline-default-TestCluster_0-(09cfa253_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12920, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
4586 [HelixController-pipeline-default-TestCluster_0-(a6e52857_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12923, capacity map: {}.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at java.util.concurrent.ForkJoinTask.getThrowableException(ForkJoinTask.java:593)
	at java.util.concurrent.ForkJoinTask.reportException(ForkJoinTask.java:677)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:735)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12923, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
4603 [HelixController-pipeline-default-TestCluster_0-(e2ccbe89_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12923, capacity map: {}.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at java.util.concurrent.ForkJoinTask.getThrowableException(ForkJoinTask.java:593)
	at java.util.concurrent.ForkJoinTask.reportException(ForkJoinTask.java:677)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:735)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12923, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testValidateWeightForAllInstances
Start test :testGetWorkflows
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testGetWorkflows
Start test :testGetWorkflow
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testGetWorkflow
Start test :testGetWorkflowConfig
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testGetWorkflowConfig
Start test :testGetWorkflowContext
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testGetWorkflowContext
Start test :testCreateWorkflow
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testCreateWorkflow
Start test :testUpdateWorkflow
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testUpdateWorkflow
Start test :testGetAndUpdateWorkflowContentStore
4755 [HelixTaskExecutor-message_handle_thread_931] ERROR org.apache.helix.messaging.handling.HelixStateTransitionHandler  - Exception while executing a state transition task TestWorkflow_Job1_0
java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.helix.messaging.handling.HelixStateTransitionHandler.invoke(HelixStateTransitionHandler.java:386)
	at org.apache.helix.messaging.handling.HelixStateTransitionHandler.handleMessage(HelixStateTransitionHandler.java:313)
	at org.apache.helix.messaging.handling.HelixTask.call(HelixTask.java:97)
	at org.apache.helix.messaging.handling.HelixTask.call(HelixTask.java:49)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: No callback implemented(or not registered) for task Backup
	at org.apache.helix.task.TaskStateModel.startTask(TaskStateModel.java:318)
	at org.apache.helix.task.TaskStateModel.onBecomeRunningFromInit(TaskStateModel.java:79)
	... 12 more
4755 [HelixTaskExecutor-message_handle_thread_59] ERROR org.apache.helix.messaging.handling.HelixStateTransitionHandler  - Exception while executing a state transition task TestWorkflow_Job1_1
java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.helix.messaging.handling.HelixStateTransitionHandler.invoke(HelixStateTransitionHandler.java:386)
	at org.apache.helix.messaging.handling.HelixStateTransitionHandler.handleMessage(HelixStateTransitionHandler.java:313)
	at org.apache.helix.messaging.handling.HelixTask.call(HelixTask.java:97)
	at org.apache.helix.messaging.handling.HelixTask.call(HelixTask.java:49)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: No callback implemented(or not registered) for task ReIndex
	at org.apache.helix.task.TaskStateModel.startTask(TaskStateModel.java:318)
	at org.apache.helix.task.TaskStateModel.onBecomeRunningFromInit(TaskStateModel.java:79)
	... 12 more
4758 [HelixTaskExecutor-message_handle_thread_931] ERROR org.apache.helix.util.StatusUpdateUtil  - StatusUpdate Error record: 10000cadc580013__TestWorkflow_Job1, {}{HELIX_ERROR     20210603-100756.000073 STATE_TRANSITION 85e3b2ce-9d94-4809-b414-a22a47abfdde={AdditionalInfo=Exception while executing a state transition task TestWorkflow_Job1_0java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.helix.messaging.handling.HelixStateTransitionHandler.invoke(HelixStateTransitionHandler.java:386)
	at org.apache.helix.messaging.handling.HelixStateTransitionHandler.handleMessage(HelixStateTransitionHandler.java:313)
	at org.apache.helix.messaging.handling.HelixTask.call(HelixTask.java:97)
	at org.apache.helix.messaging.handling.HelixTask.call(HelixTask.java:49)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: No callback implemented(or not registered) for task Backup
	at org.apache.helix.task.TaskStateModel.startTask(TaskStateModel.java:318)
	at org.apache.helix.task.TaskStateModel.onBecomeRunningFromInit(TaskStateModel.java:79)
	... 12 more
, Class=class org.apache.helix.messaging.handling.HelixStateTransitionHandler, MSG_ID=c531b39e-181c-4170-a4fd-45a72fd94e1c, Message state=READ}}{}
4758 [HelixTaskExecutor-message_handle_thread_931] ERROR org.apache.helix.participant.statemachine.StateModel  - Default rollback method invoked on error. Error Code: ERROR
4758 [HelixTaskExecutor-message_handle_thread_59] ERROR org.apache.helix.util.StatusUpdateUtil  - StatusUpdate Error record: 10000cadc58000d__TestWorkflow_Job1, {}{HELIX_ERROR     20210603-100756.000073 STATE_TRANSITION 0862a125-1deb-4e54-a03c-966b7c216413={AdditionalInfo=Exception while executing a state transition task TestWorkflow_Job1_1java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.helix.messaging.handling.HelixStateTransitionHandler.invoke(HelixStateTransitionHandler.java:386)
	at org.apache.helix.messaging.handling.HelixStateTransitionHandler.handleMessage(HelixStateTransitionHandler.java:313)
	at org.apache.helix.messaging.handling.HelixTask.call(HelixTask.java:97)
	at org.apache.helix.messaging.handling.HelixTask.call(HelixTask.java:49)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: No callback implemented(or not registered) for task ReIndex
	at org.apache.helix.task.TaskStateModel.startTask(TaskStateModel.java:318)
	at org.apache.helix.task.TaskStateModel.onBecomeRunningFromInit(TaskStateModel.java:79)
	... 12 more
, Class=class org.apache.helix.messaging.handling.HelixStateTransitionHandler, MSG_ID=1febe01b-3f8b-45d7-b04a-0ee0137d3faa, Message state=READ}}{}
4760 [HelixTaskExecutor-message_handle_thread_59] ERROR org.apache.helix.participant.statemachine.StateModel  - Default rollback method invoked on error. Error Code: ERROR
4762 [HelixTaskExecutor-message_handle_thread_931] ERROR org.apache.helix.messaging.handling.HelixTask  - Message execution failed. msgId: c531b39e-181c-4170-a4fd-45a72fd94e1c, errorMsg: java.lang.reflect.InvocationTargetException
4764 [HelixTaskExecutor-message_handle_thread_59] ERROR org.apache.helix.messaging.handling.HelixTask  - Message execution failed. msgId: 1febe01b-3f8b-45d7-b04a-0ee0137d3faa, errorMsg: java.lang.reflect.InvocationTargetException
4764 [HelixTaskExecutor-message_handle_thread_931] ERROR org.apache.helix.util.StatusUpdateUtil  - StatusUpdate Error record: 10000cadc580013__TestWorkflow_Job1, {}{HELIX_ERROR     20210603-100756.000079 STATE_TRANSITION b6bff961-2a73-4fa4-8b7d-c988417af3d0={AdditionalInfo=Message execution failed. msgId: c531b39e-181c-4170-a4fd-45a72fd94e1c, errorMsg: java.lang.reflect.InvocationTargetException, Class=class org.apache.helix.messaging.handling.HelixStateTransitionHandler, MSG_ID=c531b39e-181c-4170-a4fd-45a72fd94e1c, Message state=READ}}{}
4764 [HelixTaskExecutor-message_handle_thread_59] ERROR org.apache.helix.util.StatusUpdateUtil  - StatusUpdate Error record: 10000cadc58000d__TestWorkflow_Job1, {}{HELIX_ERROR     20210603-100756.000079 STATE_TRANSITION 9be34c6f-3091-4665-857c-6649e4aef7e9={AdditionalInfo=Message execution failed. msgId: 1febe01b-3f8b-45d7-b04a-0ee0137d3faa, errorMsg: java.lang.reflect.InvocationTargetException, Class=class org.apache.helix.messaging.handling.HelixStateTransitionHandler, MSG_ID=1febe01b-3f8b-45d7-b04a-0ee0137d3faa, Message state=READ}}{}
4765 [HelixTaskExecutor-message_handle_thread_931] ERROR org.apache.helix.messaging.handling.HelixStateTransitionHandler  - Skip internal error. errCode: ERROR, errMsg: null
4765 [HelixTaskExecutor-message_handle_thread_59] ERROR org.apache.helix.messaging.handling.HelixStateTransitionHandler  - Skip internal error. errCode: ERROR, errMsg: null
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testGetAndUpdateWorkflowContentStore
Start test :testInvalidGetAndUpdateWorkflowContentStore
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testInvalidGetAndUpdateWorkflowContentStore
Start test :testDeleteWorkflow
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testDeleteWorkflow
Start test :testGetClusters
5514 [HelixController-pipeline-task-StoppableTestCluster-(421f013f_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB2
5514 [HelixController-pipeline-task-StoppableTestCluster-(421f013f_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB1
5514 [HelixController-pipeline-task-StoppableTestCluster-(421f013f_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_0_JOB0
5515 [HelixController-pipeline-task-StoppableTestCluster-(421f013f_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB1
5515 [HelixController-pipeline-task-StoppableTestCluster-(421f013f_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_2_JOB0
5515 [HelixController-pipeline-task-StoppableTestCluster-(421f013f_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB1
5515 [HelixController-pipeline-task-StoppableTestCluster-(421f013f_TASK)] ERROR org.apache.helix.task.JobDispatcher  - Job configuration is NULL for Workflow_1_JOB0
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
Start test :testGetAddTaskUserContent
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testGetAddTaskUserContent
Start test :testInvalidGetAddTaskUserContent
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testInvalidGetAddTaskUserContent
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
Start test :testGetResources
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testGetResources
Start test :testGetResource
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testGetResource
Start test :testAddResources
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testAddResources
Start test :testResourceConfig
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testResourceConfig
Start test :testIdealState
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testIdealState
Start test :testExternalView
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testExternalView
Start test :testCustomizedView
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testCustomizedView
Start test :testPartitionHealth
End test :createDummyMapping
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testPartitionHealth
Start test :testResourceHealth
End test :createDummyMapping
End test :createDummyMapping
End test :createDummyMapping
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testResourceHealth
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :updateResourceConfig
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :deleteFromResourceConfig
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :updateResourceIdealState
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :deleteFromResourceIdealState
6941 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
6941 [HelixController-pipeline-default-TestCluster_0-(17d3b275_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetPartitionCapacity(WagedValidationUtil.java:86)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.fetchCapacityUsage(AssignableReplica.java:156)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.<init>(AssignableReplica.java:65)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableReplicas$14(ClusterModelProvider.java:483)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableReplicas(ClusterModelProvider.java:488)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:147)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
6954 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
6955 [qtp584681920-1880] ERROR org.apache.helix.model.IdealState  - idealState:invalidWagedResource does not have number of partitions (was -1).
6955 [qtp584681920-1880] ERROR org.apache.helix.rest.server.resources.helix.ResourceAccessor  - Failed to add resource invalidWagedResource with weight in cluster TestCluster_0!
org.apache.helix.HelixException: IdealState is null or invalid!
	at org.apache.helix.manager.zk.ZKHelixAdmin.addResourceWithWeight(ZKHelixAdmin.java:1880)
	at org.apache.helix.rest.server.resources.helix.ResourceAccessor.addResource(ResourceAccessor.java:299)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory$1.invoke(ResourceMethodInvocationHandlerFactory.java:81)
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:151)
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:171)
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$ResponseOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:152)
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:104)
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:387)
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:331)
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:103)
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:271)
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:271)
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:267)
	at org.glassfish.jersey.internal.Errors.process(Errors.java:315)
	at org.glassfish.jersey.internal.Errors.process(Errors.java:297)
	at org.glassfish.jersey.internal.Errors.process(Errors.java:267)
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:297)
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:254)
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:1028)
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:372)
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:382)
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:345)
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:220)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:698)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:526)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1110)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:453)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1044)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:136)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)
	at org.eclipse.jetty.server.Server.handle(Server.java:445)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:278)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:216)
	at org.eclipse.jetty.io.AbstractConnection$1.run(AbstractConnection.java:505)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:601)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:532)
	at java.lang.Thread.run(Thread.java:748)
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
6955 [HelixController-pipeline-default-TestCluster_0-(60240e04_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for partial rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:534)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:363)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetPartitionCapacity(WagedValidationUtil.java:86)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.fetchCapacityUsage(AssignableReplica.java:156)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.<init>(AssignableReplica.java:65)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableReplicas$14(ClusterModelProvider.java:483)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableReplicas(ClusterModelProvider.java:488)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:147)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForPartialRebalance(ClusterModelProvider.java:77)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:531)
	... 10 more
6975 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
6976 [HelixController-pipeline-default-TestCluster_0-(b7f1c40e_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetPartitionCapacity(WagedValidationUtil.java:86)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.fetchCapacityUsage(AssignableReplica.java:156)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.<init>(AssignableReplica.java:65)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableReplicas$14(ClusterModelProvider.java:483)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableReplicas(ClusterModelProvider.java:488)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:147)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
6991 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12918, capacity map: {}.
6993 [HelixController-pipeline-default-TestCluster_0-(8e1d8a4e_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12918, capacity map: {}.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at java.util.concurrent.ForkJoinTask.getThrowableException(ForkJoinTask.java:593)
	at java.util.concurrent.ForkJoinTask.reportException(ForkJoinTask.java:677)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:735)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12918, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
7011 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12918, capacity map: {}.
7012 [HelixController-pipeline-default-TestCluster_0-(76b73a1d_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12918, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.pollAndExecCC(ForkJoinPool.java:1190)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1879)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
7027 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12921, capacity map: {}.
7029 [HelixController-pipeline-default-TestCluster_0-(70543f8a_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12927, capacity map: {}.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at java.util.concurrent.ForkJoinTask.getThrowableException(ForkJoinTask.java:593)
	at java.util.concurrent.ForkJoinTask.reportException(ForkJoinTask.java:677)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:735)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12927, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.execLocalTasks(ForkJoinPool.java:1040)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1058)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
7048 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12918, capacity map: {}.
7049 [HelixController-pipeline-default-TestCluster_0-(f04192b4_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12921, capacity map: {}.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at java.util.concurrent.ForkJoinTask.getThrowableException(ForkJoinTask.java:593)
	at java.util.concurrent.ForkJoinTask.reportException(ForkJoinTask.java:677)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:735)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12921, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
7071 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12921, capacity map: {}.
7072 [HelixController-pipeline-default-TestCluster_0-(fadf7aec_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12920, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
7087 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12925, capacity map: {}.
7088 [HelixController-pipeline-default-TestCluster_0-(1c640f10_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12920, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
7107 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12918, capacity map: {}.
7108 [HelixController-pipeline-default-TestCluster_0-(1a691053_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12920, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
7126 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12919, capacity map: {}.
7127 [HelixController-pipeline-default-TestCluster_0-(62a664f5_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12920, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
7140 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12921, capacity map: {}.
7141 [HelixController-pipeline-default-TestCluster_0-(796b1059_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12920, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
7154 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12925, capacity map: {}.
7155 [HelixController-pipeline-default-TestCluster_0-(45243659_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12922, capacity map: {}.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at java.util.concurrent.ForkJoinTask.getThrowableException(ForkJoinTask.java:593)
	at java.util.concurrent.ForkJoinTask.reportException(ForkJoinTask.java:677)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:735)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12922, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
7181 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12925, capacity map: {}.
7182 [HelixController-pipeline-default-TestCluster_0-(f65aa426_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12925, capacity map: {}.
	at sun.reflect.GeneratedConstructorAccessor65.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at java.util.concurrent.ForkJoinTask.getThrowableException(ForkJoinTask.java:593)
	at java.util.concurrent.ForkJoinTask.reportException(ForkJoinTask.java:677)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:735)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12925, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
7199 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
7200 [HelixController-pipeline-default-TestCluster_0-(46dbcafb_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12923, capacity map: {}.
	at sun.reflect.GeneratedConstructorAccessor65.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at java.util.concurrent.ForkJoinTask.getThrowableException(ForkJoinTask.java:593)
	at java.util.concurrent.ForkJoinTask.reportException(ForkJoinTask.java:677)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:735)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12923, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
7219 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
7221 [HelixController-pipeline-default-TestCluster_0-(9bcc2a72_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetPartitionCapacity(WagedValidationUtil.java:86)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.fetchCapacityUsage(AssignableReplica.java:156)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.<init>(AssignableReplica.java:65)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableReplicas$14(ClusterModelProvider.java:483)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableReplicas(ClusterModelProvider.java:488)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:147)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
7233 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
7235 [HelixController-pipeline-default-TestCluster_0-(a7583b45_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for partial rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:534)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:363)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetPartitionCapacity(WagedValidationUtil.java:86)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.fetchCapacityUsage(AssignableReplica.java:156)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.<init>(AssignableReplica.java:65)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableReplicas$14(ClusterModelProvider.java:483)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableReplicas(ClusterModelProvider.java:488)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:147)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForPartialRebalance(ClusterModelProvider.java:77)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:531)
	... 10 more
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
Start test :testIsInstanceStoppable
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testIsInstanceStoppable
Start test :testGetAllMessages
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testGetAllMessages
Start test :testGetMessagesByStateModelDef
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testGetMessagesByStateModelDef
Start test :testGetAllInstances
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testGetAllInstances
Start test :testGetInstanceById
7297 [qtp584681920-2094] ERROR org.apache.helix.util.InstanceValidationUtil  - Cluster config %s is not turned on, which is required for instance stability check.
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testGetInstanceById
Start test :testAddInstance
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testAddInstance
Start test :testDeleteInstance
7318 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
7319 [HelixController-pipeline-default-TestCluster_0-(93820fed_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12918TEST, capacity map: {}.
	at sun.reflect.GeneratedConstructorAccessor65.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at java.util.concurrent.ForkJoinTask.getThrowableException(ForkJoinTask.java:593)
	at java.util.concurrent.ForkJoinTask.reportException(ForkJoinTask.java:677)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:735)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12918TEST, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
Start test :updateInstance
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
7334 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
7335 [HelixController-pipeline-default-TestCluster_0-(1056cc7a_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetPartitionCapacity(WagedValidationUtil.java:86)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.fetchCapacityUsage(AssignableReplica.java:156)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.<init>(AssignableReplica.java:65)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableReplicas$14(ClusterModelProvider.java:483)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableReplicas(ClusterModelProvider.java:488)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:147)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
7346 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
7347 [HelixController-pipeline-default-TestCluster_0-(05c75aad_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for partial rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:534)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:363)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetPartitionCapacity(WagedValidationUtil.java:86)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.fetchCapacityUsage(AssignableReplica.java:156)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.<init>(AssignableReplica.java:65)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableReplicas$14(ClusterModelProvider.java:483)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableReplicas(ClusterModelProvider.java:488)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:147)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForPartialRebalance(ClusterModelProvider.java:77)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:531)
	... 10 more
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
7359 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
7360 [HelixController-pipeline-default-TestCluster_0-(d7aafd46_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for partial rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:534)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:363)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetPartitionCapacity(WagedValidationUtil.java:86)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.fetchCapacityUsage(AssignableReplica.java:156)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.<init>(AssignableReplica.java:65)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableReplicas$14(ClusterModelProvider.java:483)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableReplicas(ClusterModelProvider.java:488)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:147)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForPartialRebalance(ClusterModelProvider.java:77)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:531)
	... 10 more
7372 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
7373 [HelixController-pipeline-default-TestCluster_0-(1bdbbfda_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetPartitionCapacity(WagedValidationUtil.java:86)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.fetchCapacityUsage(AssignableReplica.java:156)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.<init>(AssignableReplica.java:65)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableReplicas$14(ClusterModelProvider.java:483)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableReplicas(ClusterModelProvider.java:488)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:147)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
7386 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
7387 [HelixController-pipeline-default-TestCluster_0-(4dcaae75_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
	at sun.reflect.GeneratedConstructorAccessor65.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at java.util.concurrent.ForkJoinTask.getThrowableException(ForkJoinTask.java:593)
	at java.util.concurrent.ForkJoinTask.reportException(ForkJoinTask.java:677)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:735)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableReplicas(ClusterModelProvider.java:488)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:147)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetPartitionCapacity(WagedValidationUtil.java:86)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.fetchCapacityUsage(AssignableReplica.java:156)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.<init>(AssignableReplica.java:65)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableReplicas$14(ClusterModelProvider.java:483)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :updateInstance
Start test :updateInstanceConfig
7406 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
7407 [HelixController-pipeline-default-TestCluster_0-(8504d26c_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetPartitionCapacity(WagedValidationUtil.java:86)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.fetchCapacityUsage(AssignableReplica.java:156)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.<init>(AssignableReplica.java:65)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableReplicas$14(ClusterModelProvider.java:483)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableReplicas(ClusterModelProvider.java:488)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:147)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
7419 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
7420 [HelixController-pipeline-default-TestCluster_0-(cc169868_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for partial rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:534)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:363)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetPartitionCapacity(WagedValidationUtil.java:86)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.fetchCapacityUsage(AssignableReplica.java:156)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.<init>(AssignableReplica.java:65)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableReplicas$14(ClusterModelProvider.java:483)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableReplicas(ClusterModelProvider.java:488)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:147)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForPartialRebalance(ClusterModelProvider.java:77)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:531)
	... 10 more
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
7441 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
7442 [HelixController-pipeline-default-TestCluster_0-(667e001f_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetPartitionCapacity(WagedValidationUtil.java:86)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.fetchCapacityUsage(AssignableReplica.java:156)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.<init>(AssignableReplica.java:65)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableReplicas$14(ClusterModelProvider.java:483)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableReplicas(ClusterModelProvider.java:488)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:147)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
7465 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
End test :updateInstanceConfig
7466 [HelixController-pipeline-default-TestCluster_0-(285c9e64_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for partial rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:534)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:363)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetPartitionCapacity(WagedValidationUtil.java:86)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.fetchCapacityUsage(AssignableReplica.java:156)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.<init>(AssignableReplica.java:65)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableReplicas$14(ClusterModelProvider.java:483)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool.helpComplete(ForkJoinPool.java:1870)
	at java.util.concurrent.ForkJoinPool.externalHelpComplete(ForkJoinPool.java:2467)
	at java.util.concurrent.ForkJoinTask.externalAwaitDone(ForkJoinTask.java:324)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:405)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableReplicas(ClusterModelProvider.java:488)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:147)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForPartialRebalance(ClusterModelProvider.java:77)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:531)
	... 10 more
Start test :deleteInstanceConfig
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
7490 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
7491 [HelixController-pipeline-default-TestCluster_0-(93d5a429_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
	at sun.reflect.GeneratedConstructorAccessor65.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at java.util.concurrent.ForkJoinTask.getThrowableException(ForkJoinTask.java:593)
	at java.util.concurrent.ForkJoinTask.reportException(ForkJoinTask.java:677)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:735)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableReplicas(ClusterModelProvider.java:488)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:147)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the resource: TestCluster_0_db_0, partition: TestCluster_0_db_0_0, weight map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetPartitionCapacity(WagedValidationUtil.java:86)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.fetchCapacityUsage(AssignableReplica.java:156)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableReplica.<init>(AssignableReplica.java:65)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableReplicas$14(ClusterModelProvider.java:483)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
End test :deleteInstanceConfig
Start test :checkUpdateFails
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :checkUpdateFails
Start test :testValidateWeightForInstance
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
7723 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12919, capacity map: {}.
End test :testValidateWeightForInstance
Start test :testValidateDeltaInstanceConfigForUpdate
7724 [HelixController-pipeline-default-TestCluster_0-(738a164a_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12925, capacity map: {}.
	at sun.reflect.GeneratedConstructorAccessor65.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at java.util.concurrent.ForkJoinTask.getThrowableException(ForkJoinTask.java:593)
	at java.util.concurrent.ForkJoinTask.reportException(ForkJoinTask.java:677)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:735)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12925, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
7738 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12925, capacity map: {}.
7739 [HelixController-pipeline-default-TestCluster_0-(8049c22b_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for partial rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:534)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:363)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: org.apache.helix.HelixException: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12919, capacity map: {}.
	at sun.reflect.GeneratedConstructorAccessor65.newInstance(Unknown Source)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at java.util.concurrent.ForkJoinTask.getThrowableException(ForkJoinTask.java:593)
	at java.util.concurrent.ForkJoinTask.reportException(ForkJoinTask.java:677)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:735)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForPartialRebalance(ClusterModelProvider.java:77)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:531)
	... 10 more
Caused by: org.apache.helix.HelixException: The required capacity keys: [FOO, BAR] are not fully configured in the instance: TestCluster_0localhost_12919, capacity map: {}.
	at org.apache.helix.controller.rebalancer.util.WagedValidationUtil.validateAndGetInstanceCapacity(WagedValidationUtil.java:56)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.fetchInstanceCapacity(AssignableNode.java:359)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:78)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.execLocalTasks(ForkJoinPool.java:1040)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1058)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
7754 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: java.lang.IllegalArgumentException: Domain for instance TestCluster_0localhost_12918 is not set, fail the topology-aware placement!
7755 [HelixController-pipeline-default-TestCluster_0-(696b81d8_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: java.lang.IllegalArgumentException: Domain for instance TestCluster_0localhost_12920 is not set, fail the topology-aware placement!
	at org.apache.helix.controller.rebalancer.topology.Topology.computeInstanceTopologyMapHelper(Topology.java:282)
	at org.apache.helix.controller.rebalancer.topology.Topology.computeInstanceTopologyMap(Topology.java:333)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.computeFaultZone(AssignableNode.java:314)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:79)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
7768 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: Domain for instance TestCluster_0localhost_12921 is not set, fail the topology-aware placement!
7768 [qtp584681920-1922] ERROR org.apache.helix.rest.server.resources.helix.PerInstanceAccessor  - Invalid topology setting for Instance : {}. Fail the config update
java.lang.IllegalArgumentException: Domain-Value pair InvalidDomainValue is not valid.
	at org.apache.helix.model.InstanceConfig.getDomainAsMap(InstanceConfig.java:165)
	at org.apache.helix.controller.rebalancer.topology.Topology.computeInstanceTopologyMapHelper(Topology.java:279)
	at org.apache.helix.controller.rebalancer.topology.Topology.computeInstanceTopologyMap(Topology.java:333)
	at org.apache.helix.model.InstanceConfig.validateTopologySettingInInstanceConfig(InstanceConfig.java:676)
	at org.apache.helix.rest.server.resources.helix.PerInstanceAccessor.validateDeltaTopologySettingInInstanceConfig(PerInstanceAccessor.java:637)
	at org.apache.helix.rest.server.resources.helix.PerInstanceAccessor.updateInstanceConfig(PerInstanceAccessor.java:354)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory$1.invoke(ResourceMethodInvocationHandlerFactory.java:81)
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:151)
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:171)
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$ResponseOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:152)
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:104)
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:387)
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:331)
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:103)
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:271)
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:271)
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:267)
	at org.glassfish.jersey.internal.Errors.process(Errors.java:315)
	at org.glassfish.jersey.internal.Errors.process(Errors.java:297)
	at org.glassfish.jersey.internal.Errors.process(Errors.java:267)
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:297)
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:254)
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:1028)
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:372)
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:382)
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:345)
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:220)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:698)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:526)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1110)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:453)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1044)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:136)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)
	at org.eclipse.jetty.server.Server.handle(Server.java:445)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:278)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:216)
	at org.eclipse.jetty.io.AbstractConnection$1.run(AbstractConnection.java:505)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:601)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:532)
	at java.lang.Thread.run(Thread.java:748)
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
7769 [HelixController-pipeline-default-TestCluster_0-(f0f123bc_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for global rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:437)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:360)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: Domain for instance TestCluster_0localhost_12925 is not set, fail the topology-aware placement!
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at java.util.concurrent.ForkJoinTask.getThrowableException(ForkJoinTask.java:593)
	at java.util.concurrent.ForkJoinTask.reportException(ForkJoinTask.java:677)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:735)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForBaseline(ClusterModelProvider.java:97)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.globalRebalance(WagedRebalancer.java:434)
	... 10 more
Caused by: java.lang.IllegalArgumentException: Domain for instance TestCluster_0localhost_12925 is not set, fail the topology-aware placement!
	at org.apache.helix.controller.rebalancer.topology.Topology.computeInstanceTopologyMapHelper(Topology.java:282)
	at org.apache.helix.controller.rebalancer.topology.Topology.computeInstanceTopologyMap(Topology.java:333)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.computeFaultZone(AssignableNode.java:314)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:79)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
End test :testValidateDeltaInstanceConfigForUpdate
Start test :testGetResourcesOnInstance
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
testCLuster :org.apache.helix.rest.metadatastore.accessor.TestZkRoutingDataWriter   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@62ba2ab9
End test :testGetResourcesOnInstance
7796 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: Domain for instance TestCluster_0localhost_12921 is not set, fail the topology-aware placement!
7797 [HelixController-pipeline-default-TestCluster_0-(e344146d_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for partial rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:534)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:363)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: Domain for instance TestCluster_0localhost_12925 is not set, fail the topology-aware placement!
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at java.util.concurrent.ForkJoinTask.getThrowableException(ForkJoinTask.java:593)
	at java.util.concurrent.ForkJoinTask.reportException(ForkJoinTask.java:677)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:735)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForPartialRebalance(ClusterModelProvider.java:77)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:531)
	... 10 more
Caused by: java.lang.IllegalArgumentException: Domain for instance TestCluster_0localhost_12925 is not set, fail the topology-aware placement!
	at org.apache.helix.controller.rebalancer.topology.Topology.computeInstanceTopologyMapHelper(Topology.java:282)
	at org.apache.helix.controller.rebalancer.topology.Topology.computeInstanceTopologyMap(Topology.java:333)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.computeFaultZone(AssignableNode.java:314)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:79)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
7821 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: Domain for instance TestCluster_0localhost_12921 is not set, fail the topology-aware placement!
7822 [HelixController-pipeline-default-TestCluster_0-(8290014b_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for partial rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:534)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:363)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: Domain for instance TestCluster_0localhost_12919 is not set, fail the topology-aware placement!
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at java.util.concurrent.ForkJoinTask.getThrowableException(ForkJoinTask.java:593)
	at java.util.concurrent.ForkJoinTask.reportException(ForkJoinTask.java:677)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:735)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForPartialRebalance(ClusterModelProvider.java:77)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:531)
	... 10 more
Caused by: java.lang.IllegalArgumentException: Domain for instance TestCluster_0localhost_12919 is not set, fail the topology-aware placement!
	at org.apache.helix.controller.rebalancer.topology.Topology.computeInstanceTopologyMapHelper(Topology.java:282)
	at org.apache.helix.controller.rebalancer.topology.Topology.computeInstanceTopologyMap(Topology.java:333)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.computeFaultZone(AssignableNode.java:314)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:79)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.execLocalTasks(ForkJoinPool.java:1040)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1058)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
7837 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: Domain for instance TestCluster_0localhost_12921 is not set, fail the topology-aware placement!
7838 [HelixController-pipeline-default-TestCluster_0-(64dc2f0e_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for partial rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:534)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:363)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: java.lang.IllegalArgumentException: Domain for instance TestCluster_0localhost_12921 is not set, fail the topology-aware placement!
	at org.apache.helix.controller.rebalancer.topology.Topology.computeInstanceTopologyMapHelper(Topology.java:282)
	at org.apache.helix.controller.rebalancer.topology.Topology.computeInstanceTopologyMap(Topology.java:333)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.computeFaultZone(AssignableNode.java:314)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:79)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinTask.doInvoke(ForkJoinTask.java:401)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:734)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForPartialRebalance(ClusterModelProvider.java:77)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:531)
	... 10 more
7851 [HelixController-async_tasks-TestCluster_0] ERROR org.apache.helix.controller.stages.CurrentStateComputationStage  - Failed to report instance capacity metrics. Exception message: Domain for instance TestCluster_0localhost_12921 is not set, fail the topology-aware placement!
7852 [HelixController-pipeline-default-TestCluster_0-(6decff6f_DEFAULT)] ERROR org.apache.helix.controller.rebalancer.waged.WagedRebalancer  - Failed to calculate the new assignments.
org.apache.helix.HelixRebalanceException: Failed to generate cluster model for partial rebalance. Failure Type: INVALID_CLUSTER_STATUS
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:534)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleAssignment(WagedRebalancer.java:363)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeBestPossibleStates(WagedRebalancer.java:333)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.computeNewIdealStates(WagedRebalancer.java:268)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.computeResourceBestPossibleStateWithWagedRebalancer(BestPossibleStateCalcStage.java:314)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.compute(BestPossibleStateCalcStage.java:168)
	at org.apache.helix.controller.stages.BestPossibleStateCalcStage.process(BestPossibleStateCalcStage.java:88)
	at org.apache.helix.controller.pipeline.Pipeline.handle(Pipeline.java:68)
	at org.apache.helix.controller.GenericHelixController.handleEvent(GenericHelixController.java:842)
	at org.apache.helix.controller.GenericHelixController.access$500(GenericHelixController.java:132)
	at org.apache.helix.controller.GenericHelixController$ClusterEventProcessor.run(GenericHelixController.java:1526)
Caused by: java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: Domain for instance TestCluster_0localhost_12919 is not set, fail the topology-aware placement!
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at java.util.concurrent.ForkJoinTask.getThrowableException(ForkJoinTask.java:593)
	at java.util.concurrent.ForkJoinTask.reportException(ForkJoinTask.java:677)
	at java.util.concurrent.ForkJoinTask.invoke(ForkJoinTask.java:735)
	at java.util.stream.ReduceOps$ReduceOp.evaluateParallel(ReduceOps.java:714)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:233)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:499)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.getAllAssignableNodes(ClusterModelProvider.java:439)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModel(ClusterModelProvider.java:141)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.generateClusterModelForPartialRebalance(ClusterModelProvider.java:77)
	at org.apache.helix.controller.rebalancer.waged.WagedRebalancer.partialRebalance(WagedRebalancer.java:531)
	... 10 more
Caused by: java.lang.IllegalArgumentException: Domain for instance TestCluster_0localhost_12919 is not set, fail the topology-aware placement!
	at org.apache.helix.controller.rebalancer.topology.Topology.computeInstanceTopologyMapHelper(Topology.java:282)
	at org.apache.helix.controller.rebalancer.topology.Topology.computeInstanceTopologyMap(Topology.java:333)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.computeFaultZone(AssignableNode.java:314)
	at org.apache.helix.controller.rebalancer.waged.model.AssignableNode.<init>(AssignableNode.java:79)
	at org.apache.helix.controller.rebalancer.waged.model.ClusterModelProvider.lambda$getAllAssignableNodes$12(ClusterModelProvider.java:438)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1556)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:747)
	at java.util.stream.ReduceOps$ReduceTask.doLeaf(ReduceOps.java:721)
	at java.util.stream.AbstractTask.compute(AbstractTask.java:316)
	at java.util.concurrent.CountedCompleter.exec(CountedCompleter.java:731)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.execLocalTasks(ForkJoinPool.java:1040)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1058)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
Start test :testInvalidHelixRestServerInitialization
10397 [main] ERROR org.apache.helix.rest.server.HelixRestServer  - Failed to initialize helix rest server. Tearing down.
10399 [main] ERROR org.apache.helix.rest.server.HelixRestServer  - Failed to initialize helix rest server. Tearing down.
End test :testInvalidHelixRestServerInitialization
70426 [main] ERROR org.apache.helix.TestHelper  - verifier time out, consider try longer timeout, stack trace[java.lang.Thread.getStackTrace(Thread.java:1559), org.apache.helix.TestHelper.verify(TestHelper.java:813), org.apache.helix.rest.server.TestDefaultMonitoringMbeans.testMBeanApplicationName(TestDefaultMonitoringMbeans.java:90), sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method), sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62), sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43), java.lang.reflect.Method.invoke(Method.java:498), org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:76), org.testng.internal.Invoker.invokeMethod(Invoker.java:673), org.testng.internal.Invoker.invokeTestMethod(Invoker.java:846), org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1170), org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:125), org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:109), org.testng.TestRunner.runWorkers(TestRunner.java:1147), org.testng.TestRunner.privateRun(TestRunner.java:749), org.testng.TestRunner.run(TestRunner.java:600), org.testng.SuiteRunner.runTest(SuiteRunner.java:317), org.testng.SuiteRunner.runSequentially(SuiteRunner.java:312), org.testng.SuiteRunner.privateRun(SuiteRunner.java:274), org.testng.SuiteRunner.run(SuiteRunner.java:223), org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52), org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:86), org.testng.TestNG.runSuitesSequentially(TestNG.java:1039), org.testng.TestNG.runSuitesLocally(TestNG.java:964), org.testng.TestNG.run(TestNG.java:900), org.apache.maven.surefire.testng.TestNGExecutor.run(TestNGExecutor.java:283), org.apache.maven.surefire.testng.TestNGXmlTestSuite.execute(TestNGXmlTestSuite.java:75), org.apache.maven.surefire.testng.TestNGProvider.invoke(TestNGProvider.java:120), org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384), org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345), org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126), org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)]
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
70595 [qtp638605380-2300] ERROR org.apache.helix.zookeeper.datamodel.serializer.ZNRecordSerializer  - Exception during deserialization of bytes: TestContent
com.fasterxml.jackson.core.JsonParseException: Unrecognized token 'TestContent': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (ByteArrayInputStream); line: 1, column: 12]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:1851)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:717)
	at com.fasterxml.jackson.core.json.UTF8StreamJsonParser._reportInvalidToken(UTF8StreamJsonParser.java:3585)
	at com.fasterxml.jackson.core.json.UTF8StreamJsonParser._handleUnexpectedValue(UTF8StreamJsonParser.java:2680)
	at com.fasterxml.jackson.core.json.UTF8StreamJsonParser._nextTokenNotInObject(UTF8StreamJsonParser.java:865)
	at com.fasterxml.jackson.core.json.UTF8StreamJsonParser.nextToken(UTF8StreamJsonParser.java:757)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:4620)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4469)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3471)
	at org.apache.helix.zookeeper.datamodel.serializer.ZNRecordSerializer.deserialize(ZNRecordSerializer.java:139)
	at org.apache.helix.rest.server.resources.helix.PropertyStoreAccessor.getPropertyByPath(PropertyStoreAccessor.java:78)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory$1.invoke(ResourceMethodInvocationHandlerFactory.java:81)
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$1.run(AbstractJavaResourceMethodDispatcher.java:151)
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:171)
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$ResponseOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:152)
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:104)
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:387)
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:331)
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:103)
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:271)
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:271)
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:267)
	at org.glassfish.jersey.internal.Errors.process(Errors.java:315)
	at org.glassfish.jersey.internal.Errors.process(Errors.java:297)
	at org.glassfish.jersey.internal.Errors.process(Errors.java:267)
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:297)
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:254)
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:1028)
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:372)
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:382)
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:345)
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:220)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:698)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:526)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1110)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:453)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1044)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:136)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)
	at org.eclipse.jetty.server.Server.handle(Server.java:445)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:278)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:216)
	at org.eclipse.jetty.io.AbstractConnection$1.run(AbstractConnection.java:505)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:601)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:532)
	at java.lang.Thread.run(Thread.java:748)
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
testCLuster :org.apache.helix.rest.metadatastore.integration.TestRoutingDataUpdate   MockAuditLogger class : org.apache.helix.rest.server.AbstractTestClass$MockAuditLogger@7e669362
70741 [pool-65-thread-6] ERROR org.apache.helix.rest.server.service.InstanceServiceImpl  - Custom client side instance level health check for TestCluster/instance0.linkedin.com_1235 failed.
java.io.IOException
70817 [main] ERROR org.apache.helix.rest.client.CustomRestClientImpl  - Failed to perform customized health check. Is participant endpoint http://localhost:1000/partitionHealthStatus available?
org.apache.http.conn.ConnectTimeoutException: Timeout Exception Happened!
	at org.apache.helix.rest.client.CustomRestClientImpl.post(CustomRestClientImpl.java:138)
	at org.apache.helix.rest.client.CustomRestClientImpl.getPartitionStoppableCheck(CustomRestClientImpl.java:102)
	at org.apache.helix.rest.client.TestCustomRestClient.testGetPartitionStoppableCheckWhenTimeout(TestCustomRestClient.java:182)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:76)
	at org.testng.internal.Invoker.invokeMethod(Invoker.java:673)
	at org.testng.internal.Invoker.invokeTestMethod(Invoker.java:846)
	at org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1170)
	at org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:125)
	at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:109)
	at org.testng.TestRunner.runWorkers(TestRunner.java:1147)
	at org.testng.TestRunner.privateRun(TestRunner.java:749)
	at org.testng.TestRunner.run(TestRunner.java:600)
	at org.testng.SuiteRunner.runTest(SuiteRunner.java:317)
	at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:312)
	at org.testng.SuiteRunner.privateRun(SuiteRunner.java:274)
	at org.testng.SuiteRunner.run(SuiteRunner.java:223)
	at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52)
	at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:86)
	at org.testng.TestNG.runSuitesSequentially(TestNG.java:1039)
	at org.testng.TestNG.runSuitesLocally(TestNG.java:964)
	at org.testng.TestNG.run(TestNG.java:900)
	at org.apache.maven.surefire.testng.TestNGExecutor.run(TestNGExecutor.java:283)
	at org.apache.maven.surefire.testng.TestNGXmlTestSuite.execute(TestNGXmlTestSuite.java:75)
	at org.apache.maven.surefire.testng.TestNGProvider.invoke(TestNGProvider.java:120)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Shut down zookeeper at port 2124 in thread main
Shut down zookeeper at port 2123 in thread main
[ERROR] Tests run: 174, Failures: 1, Errors: 0, Skipped: 33, Time elapsed: 182.91 s <<< FAILURE! - in TestSuite
[ERROR] testGetClusters(org.apache.helix.rest.server.TestClusterAccessor)  Time elapsed: 0.084 s  <<< FAILURE!
java.lang.AssertionError: expected:<1> but was:<0>
	at org.apache.helix.rest.server.TestClusterAccessor.testGetClusters(TestClusterAccessor.java:95)

[INFO] 
[INFO] Results:
[INFO] 
[ERROR] Failures: 
[ERROR]   TestClusterAccessor.testGetClusters:95 expected:<1> but was:<0>
[INFO] 
[ERROR] Tests run: 174, Failures: 1, Errors: 0, Skipped: 33
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  03:11 min
[INFO] Finished at: 2021-06-03T10:09:04-07:00
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:3.0.0-M3:test (default-test) on project helix-rest: There are test failures.
[ERROR] 
[ERROR] Please refer to /Users/xialu/Documents/WorkSpace/helix/helix-rest/target/surefire-reports for the individual test results.
[ERROR] Please refer to dump files (if any exist) [date].dump, [date]-jvmRun[N].dump and [date].dumpstream.
[ERROR] -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException
